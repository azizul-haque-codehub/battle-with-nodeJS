ржнрж╛ржЗ, ржжрж╛рж░рзБржг observation!
ржПржЗ ржЬрж┐ржирж┐рж╕ржЯрж╛ ржЖрж╕рж▓рзЗ Node.js ржЖрж░ Browser environment ржПрж░ ржоржзрзНржпрзЗ global scope ржХрж┐ржнрж╛ржмрзЗ define рж╣рзЯ тАУ рж╕рзЗржЯрж╛рж░ ржХрж╛рж░ржгрзЗред

ржзрж░рж╛ ржпрж╛ржХ ржПржЗ ржХрзЛржб рж▓рж┐ржЦржЫрзЛ ЁЯСЗ

var a = 10;
console.log(this.a);

ЁЯФ╣ Browser ржП:

Browser ржП global scope = window object

var ржжрж┐рзЯрзЗ global scope ржП ржХрж┐ржЫрзБ declare ржХрж░рж▓рзЗ рж╕рзЗржЯрж╛ window ржПрж░ property рж╣рзЯрзЗ ржпрж╛рзЯ

рждрж╛ржЗ browser ржП this === window (global scope ржП)

ржПржЬржирзНржп this.a ржарж┐ржХржорждрзЛ 10 ржжрзЗржЦрж╛ржмрзЗред

ЁЯФ╣ Node.js ржП:

Node.js ржП global object рж╣рж▓ global (browser ржПрж░ window ржПрж░ ржорждрзЛ)ред

ржХрж┐ржирзНрждрзБ var ржжрж┐рзЯрзЗ declare ржХрж░рж▓рзЗ рж╕рзЗржЯрж╛ global ржП add рж╣рзЯ ржирж╛ред

Node.js ржкрзНрж░рждрж┐ржЯрж╛ ржлрж╛ржЗрж▓ржХрзЗ module рж╣рж┐рж╕рзЗржмрзЗ ржзрж░рзЗ, ржЖрж░ рж╕рзЗржЗ module ржПрж░ ржнрж┐рждрж░рзЗ scope ржЖрж▓рж╛ржжрж╛ (local)ред

рждрж╛ржЗ this ржлрж╛ржЗрж▓ рж▓рзЗржнрзЗрж▓рзЗ global ржирж╛ рж╣рзЯрзЗ ржерж╛ржХрзЗ empty object ({}) (CommonJS module system ржПрж░ ржХрж╛рж░ржгрзЗ)ред

ржПржЬржирзНржп this.a undefined ржжрзЗржЦрж╛рзЯред

рждрзБрж▓ржирж╛ ржХрж░рзЗ ржжрзЗржЦрж╛ржЗ ЁЯСЗ
Browser (console ржП):
var a = 10;
console.log(window.a); // 10
console.log(this.a);   // 10 (ржХрж╛рж░ржг this === window)

Node.js (file ржП ржЪрж╛рж▓рж╛рж▓рзЗ):
var a = 10;
console.log(global.a); // undefined
console.log(this.a);   // undefined (ржХрж╛рж░ржг this === module.exports, global ржирзЯ)


тЬЕ ржпржжрж┐ Node.js ржП ржЪрж╛ржЗ global ржПрж░ property рж╣рж┐рж╕рзЗржмрзЗ set рж╣рзЛржХ, рждрж╛рж╣рж▓рзЗ рж▓рж┐ржЦрждрзЗ рж╣ржмрзЗ:

global.a = 10;
console.log(global.a); // 10


рждрж╛рж╣рж▓рзЗ рж╕ржВржХрзНрж╖рзЗржкрзЗ:
Browser ржП var global рж╣рж▓рзЗ window ржПрж░ рж╕рж╛ржерзЗ bind рж╣рзЯ, ржХрж┐ржирзНрждрзБ Node.js ржП ржкрзНрж░рждрж┐ржЯрж╛ ржлрж╛ржЗрж▓ module-scope ржП рж░рж╛ржи ржХрж░рзЗ, рждрж╛ржЗ var рж╢рзБржзрзБ ржУржЗ ржлрж╛ржЗрж▓рзЗрж░ local ржерж╛ржХрзЗред